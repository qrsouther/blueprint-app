modules:
  macro:
    - key: blueprint-standard-source
      title: üì¶ Blueprint App - Source
      description: Create a reusable Source excerpt that can be embedded on other pages (v8.0.0)
      icon: resource:icon-assets;blueprint.png
      layout: bodied
      resource: source-display-resource
      render: native
      resolver:
        function: resolver
      config:
        resource: source-config-resource
        render: native
        viewportSize: max

    - key: blueprint-standard-embed
      title: üéØ Blueprint App - Embed
      description: Embed a Source excerpt from another page (v8.0.0)
      icon: resource:icon-assets;blueprint.png
      resource: embed-display
      render: native
      resolver:
        function: resolver

  confluence:globalSettings:
    - key: blueprint-standards-admin
      title: üìò ‚öôÔ∏è Blueprint App Admin
      description: Manage Blueprint Standards and Embeds
      icon: resource:icon-assets;blueprint.png
      resource: admin-page
      render: native
      resolver:
        function: resolver

  confluence:contentAction:
    - key: blueprint-deploy-archetype
      title: Deploy Blueprint
      resource: deploy-archetype-action
      render: native
      resolver:
        function: resolver

  consumer:
    - key: check-includes-consumer
      queue: check-includes-queue
      function: check-includes-worker

    - key: check-sources-consumer
      queue: check-sources-queue
      function: check-sources-worker

    - key: migration-consumer
      queue: migration-queue
      function: migration-worker

    - key: prune-versions-consumer
      queue: prune-versions-queue
      function: prune-versions-worker

  function:
    - key: resolver
      handler: index.handler

    - key: check-includes-worker
      handler: workers/checkIncludesWorker.handler
      timeoutSeconds: 900

    - key: check-sources-worker
      handler: workers/checkSourcesWorker.handler
      timeoutSeconds: 900

    - key: migration-worker
      handler: workers/migrationWorker.handler
      timeoutSeconds: 900

    - key: prune-versions-worker
      handler: workers/pruneVersionsWorker.handler
      timeoutSeconds: 900

resources:
  - key: source-display-resource
    path: src/source-display.jsx

  - key: source-config-resource
    path: src/source-config.jsx

  - key: embed-display
    path: src/EmbedContainer.jsx

  - key: admin-page
    path: src/admin-page.jsx

  - key: deploy-archetype-action
    path: src/deploy-archetype-action.jsx

  - key: icon-assets
    path: static/icons

app:
  id: ari:cloud:ecosystem::app/be1ff96b-d44d-4975-98d3-25b80a813bdd
  runtime:
    name: nodejs22.x

permissions:
  scopes:
    - read:confluence-content.all
    - read:confluence-space.summary
    - read:space:confluence
    - read:page:confluence
    - write:page:confluence
    - write:confluence-content
    - write:comment:confluence
    - delete:page:confluence
    - read:confluence-user
    - search:confluence
    - storage:app
